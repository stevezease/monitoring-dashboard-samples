{
    "displayName": "Node Exporter / USE Method / Cluster",
    "dashboardFilters": [
        {
            "labelKey": "cluster",
            "templateVariable": "cluster",
            "stringValue": "",
            "filterType": "RESOURCE_LABEL"
        }
    ],
    "mosaicLayout": {
        "columns": 24,
        "tiles": [
            {
                "widget": {
                    "title": "CPU Utilisation",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "((\n  instance:node_cpu_utilisation:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"}\n  *\n  instance:node_num_cpu:sum{job=\"node-exporter\", cluster=~\"${cluster.value}\"}\n) != 0 )\n/ scalar(sum(instance:node_num_cpu:sum{job=\"node-exporter\", cluster=~\"${cluster.value}\"}))\n"
                                },
                                "legendTemplate": "${labels.instance}"
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 1,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "CPU Saturation (Load1 per CPU)",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "(\n  instance:node_load1_per_cpu:ratio{job=\"node-exporter\", cluster=~\"${cluster.value}\"}\n  / scalar(count(instance:node_load1_per_cpu:ratio{job=\"node-exporter\", cluster=~\"${cluster.value}\"}))\n)  != 0\n"
                                },
                                "legendTemplate": "${labels.instance}"
                            }
                        ]
                    }
                },
                "xPos": 12,
                "yPos": 1,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "Memory Utilisation",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "(\n  instance:node_memory_utilisation:ratio{job=\"node-exporter\", cluster=~\"${cluster.value}\"}\n  / scalar(count(instance:node_memory_utilisation:ratio{job=\"node-exporter\", cluster=~\"${cluster.value}\"}))\n) != 0\n"
                                },
                                "legendTemplate": "${labels.instance}"
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 9,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "Memory Saturation (Major Page Faults)",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "instance:node_vmstat_pgmajfault:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"}"
                                },
                                "legendTemplate": "${labels.instance}"
                            }
                        ]
                    }
                },
                "xPos": 12,
                "yPos": 9,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "Network Utilisation (Bytes Receive/Transmit)",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "instance:node_network_receive_bytes_excluding_lo:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"} != 0"
                                },
                                "legendTemplate": "${labels.instance} Receive"
                            },
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "instance:node_network_transmit_bytes_excluding_lo:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"} != 0"
                                },
                                "legendTemplate": "${labels.instance} Transmit"
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 17,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "Network Saturation (Drops Receive/Transmit)",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "instance:node_network_receive_drop_excluding_lo:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"} != 0"
                                },
                                "legendTemplate": "${labels.instance} Receive"
                            },
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "instance:node_network_transmit_drop_excluding_lo:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"} != 0"
                                },
                                "legendTemplate": "${labels.instance} Transmit"
                            }
                        ]
                    }
                },
                "xPos": 12,
                "yPos": 17,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "Disk IO Utilisation",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "(\n  instance_device:node_disk_io_time_seconds:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"}\n  / scalar(count(instance_device:node_disk_io_time_seconds:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"}))\n) != 0\n"
                                },
                                "legendTemplate": "${labels.instance} ${labels.device}"
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 25,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "Disk IO Saturation",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "(\n  instance_device:node_disk_io_time_weighted_seconds:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"}\n  / scalar(count(instance_device:node_disk_io_time_weighted_seconds:rate5m{job=\"node-exporter\", cluster=~\"${cluster.value}\"}))\n) != 0\n"
                                },
                                "legendTemplate": "${labels.instance} ${labels.device}"
                            }
                        ]
                    }
                },
                "xPos": 12,
                "yPos": 25,
                "height": 7,
                "width": 12
            },
            {
                "widget": {
                    "title": "Disk Space Utilisation",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "STACKED_AREA",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum without (device) (\n  max without (fstype, mountpoint) ((\n    node_filesystem_size_bytes{job=\"node-exporter\", fstype!=\"\", cluster=~\"${cluster.value}\"}\n    -\n    node_filesystem_avail_bytes{job=\"node-exporter\", fstype!=\"\", cluster=~\"${cluster.value}\"}\n  ) != 0)\n)\n/ scalar(sum(max without (fstype, mountpoint) (node_filesystem_size_bytes{job=\"node-exporter\", fstype!=\"\", cluster=~\"${cluster.value}\"})))\n"
                                },
                                "legendTemplate": "${labels.instance}"
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 33,
                "height": 7,
                "width": 24
            }
        ]
    },
    "labels": {
        "kube-prometheus-mixin": "",
        "goog-imported-via-script": "",
        "cloud-ops-grafana-importer": "",
        "goog-imported-grafana-dashboard": "",
        "goog-imported-grafana-revision-1": "",
        "goog-imported-grafana-file-name-node_exporter_use_cluster": ""
    }
}