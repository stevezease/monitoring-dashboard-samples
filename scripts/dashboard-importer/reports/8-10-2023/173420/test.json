{
    "displayName": "kube-state-metrics-v2",
    "dashboardFilters": [
        {
            "labelKey": "cluster",
            "templateVariable": "cluster",
            "stringValue": "",
            "filterType": "RESOURCE_LABEL"
        },
        {
            "labelKey": "node",
            "templateVariable": "node",
            "stringValue": "",
            "filterType": "METRIC_LABEL"
        },
        {
            "labelKey": "namespace",
            "templateVariable": "namespace",
            "stringValue": "",
            "filterType": "RESOURCE_LABEL"
        }
    ],
    "mosaicLayout": {
        "columns": 24,
        "tiles": [
            {
                "widget": {
                    "text": {
                        "content": "### Cluster",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 0
            },
            {
                "widget": {
                    "scorecard": {
                        "gaugeView": {
                            "lowerBound": 0,
                            "upperBound": 100
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_info{cluster=~\"${cluster.value}\",node=~\"${node.value}\"}) / sum(kube_node_status_allocatable{cluster=~\"${cluster.value}\",resource=\"pods\",node=~\"${node.value}\"})"
                        }
                    },
                    "title": "Cluster Pod Requested"
                },
                "xPos": 0,
                "yPos": 3,
                "height": 4,
                "width": 6
            },
            {
                "widget": {
                    "scorecard": {
                        "gaugeView": {
                            "lowerBound": 0,
                            "upperBound": 100
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_container_resource_requests{cluster=~\"${cluster.value}\",resource=\"cpu\",node=~\"${node.value}\"})/ sum(kube_node_status_allocatable{node=~\"${node.value}\",cluster=~\"${cluster.value}\",resource=\"cpu\"})"
                        }
                    },
                    "title": "Cluster CPU Requested"
                },
                "xPos": 6,
                "yPos": 4,
                "height": 4,
                "width": 6
            },
            {
                "widget": {
                    "scorecard": {
                        "gaugeView": {
                            "lowerBound": 0,
                            "upperBound": 100
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_container_resource_requests{cluster=~\"${cluster.value}\",resource=\"memory\",node=~\"${node.value}\"}) / sum(kube_node_status_allocatable{node=~\"${node.value}\",cluster=~\"${cluster.value}\",resource=\"memory\"})"
                        }
                    },
                    "title": "Cluster Memory  Requested"
                },
                "xPos": 12,
                "yPos": 4,
                "height": 4,
                "width": 6
            },
            {
                "widget": {
                    "title": "Cluster Pod Capacity",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_node_status_allocatable{cluster=~\"${cluster.value}\",resource=\"pods\",node=~\"${node.value}\"})"
                                },
                                "legendTemplate": "allocatable"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_pod_info{node=~\"${node.value}\",cluster=~\"${cluster.value}\"})"
                                },
                                "legendTemplate": "requested"
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 5,
                "height": 5,
                "width": 6
            },
            {
                "widget": {
                    "title": "Cluster CPU Capacity",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_node_status_capacity{node=~\"${node.value}\",cluster=~\"${cluster.value}\",resource=\"cpu\"})"
                                },
                                "legendTemplate": "allocatable"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_node_status_allocatable{node=~\"${node.value}\",cluster=~\"${cluster.value}\",resource=\"cpu\"})"
                                },
                                "legendTemplate": "capacity"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_pod_container_resource_requests{cluster=~\"${cluster.value}\",resource=\"cpu\",node=~\"${node.value}\"})"
                                },
                                "legendTemplate": "requested"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_pod_container_resource_limits{cluster=~\"${cluster.value}\",resource=\"cpu\",node=~\"${node.value}\"})"
                                },
                                "legendTemplate": "limited"
                            }
                        ]
                    }
                },
                "xPos": 6,
                "yPos": 5,
                "height": 5,
                "width": 6
            },
            {
                "widget": {
                    "title": "Cluster Mem Capacity",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_node_status_allocatable{node=~\"${node.value}\",cluster=~\"${cluster.value}\",resource=\"memory\"})"
                                },
                                "legendTemplate": "allocatable"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_node_status_capacity{node=~\"${node.value}\",cluster=~\"${cluster.value}\",resource=\"memory\"})"
                                },
                                "legendTemplate": "capacity"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_pod_container_resource_requests{cluster=~\"${cluster.value}\",resource=\"memory\",node=~\"${node.value}\"})"
                                },
                                "legendTemplate": "requested"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_pod_container_resource_limits{cluster=~\"${cluster.value}\",resource=\"memory\",node=~\"${node.value}\"})"
                                },
                                "legendTemplate": "limited"
                            }
                        ]
                    }
                },
                "xPos": 12,
                "yPos": 5,
                "height": 5,
                "width": 6
            },
            {
                "widget": {
                    "text": {
                        "content": "### Node",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 10
            },
            {
                "widget": {
                    "scorecard": {
                        "sparkChartView": {
                            "sparkChartType": "SPARK_LINE"
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_node_info{cluster=~\"${cluster.value}\"})"
                        }
                    },
                    "title": "Number Of Nodes"
                },
                "xPos": 0,
                "yPos": 11,
                "height": 3,
                "width": 4
            },
            {
                "widget": {
                    "scorecard": {
                        "sparkChartView": {
                            "sparkChartType": "SPARK_LINE"
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_node_spec_unschedulable{cluster=~\"${cluster.value}\"})"
                        }
                    },
                    "title": "Nodes Unavailable"
                },
                "xPos": 4,
                "yPos": 11,
                "height": 3,
                "width": 4
            },
            {
                "widget": {
                    "title": "Node NotReady",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "kube_node_status_condition{cluster=~\"${cluster.value}\",condition=\"Ready\",status=\"false\"}==1"
                                },
                                "legendTemplate": "{{node}}"
                            }
                        ]
                    }
                },
                "xPos": 8,
                "yPos": 11,
                "height": 3,
                "width": 8
            },
            {
                "widget": {
                    "title": "Node Pressure",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "kube_node_status_condition{condition=\"DiskPressure\",cluster=~\"${cluster.value}\",status=\"true\"}==1"
                                },
                                "legendTemplate": "{{node}} {{condition}}"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "kube_node_status_condition{condition=\"MemoryPressure\",node=~\"${node.value}\",cluster=~\"${cluster.value}\",status=\"true\"}==1"
                                },
                                "legendTemplate": "{{node}} {{condition}}"
                            },
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "kube_node_status_condition{condition=~\"PIDPressure\",node=~\"${node.value}\",cluster=~\"${cluster.value}\",status=\"true\"}==1"
                                },
                                "legendTemplate": "{{node}} {{condition}}"
                            }
                        ]
                    }
                },
                "xPos": 16,
                "yPos": 11,
                "height": 3,
                "width": 8
            },
            {
                "widget": {
                    "title": "node number",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "sum(kube_node_info{cluster=~\"${cluster.value}\"})"
                                },
                                "legendTemplate": ""
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 14,
                "height": 7,
                "width": 24
            },
            {
                "widget": {
                    "text": {
                        "content": "### Deployments",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 11
            },
            {
                "widget": {
                    "text": {
                        "content": "### Statefuleset",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 12
            },
            {
                "widget": {
                    "text": {
                        "content": "### Pods",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 13
            },
            {
                "widget": {
                    "title": "Pods restart in 30m",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "changes(kube_pod_container_status_restarts_total{namespace=~\"${namespace.value}\",cluster=~\"${cluster.value}\"}[30m])>1"
                                },
                                "legendTemplate": "{{pod}}"
                            }
                        ]
                    }
                },
                "xPos": 0,
                "yPos": 26,
                "height": 9,
                "width": 6
            },
            {
                "widget": {
                    "title": "Evicted",
                    "xyChart": {
                        "dataSets": [
                            {
                                "plotType": "LINE",
                                "timeSeriesQuery": {
                                    "prometheusQuery": "kube_pod_status_reason{cluster=~\"${cluster.value}\",namespace=~\"${namespace.value}\", reason=\"Evicted\"}==1"
                                },
                                "legendTemplate": "{{pod}}"
                            }
                        ]
                    }
                },
                "xPos": 6,
                "yPos": 26,
                "height": 9,
                "width": 6
            },
            {
                "widget": {
                    "scorecard": {
                        "sparkChartView": {
                            "sparkChartType": "SPARK_LINE"
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_status_phase{cluster=~\"${cluster.value}\",namespace=~\"${namespace.value}\", phase=\"Running\"})"
                        }
                    },
                    "title": "Pods Running"
                },
                "xPos": 12,
                "yPos": 26,
                "height": 3,
                "width": 12
            },
            {
                "widget": {
                    "scorecard": {
                        "sparkChartView": {
                            "sparkChartType": "SPARK_LINE"
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_status_phase{cluster=~\"${cluster.value}\",namespace=~\"${namespace.value}\", phase=\"Succeeded\"})"
                        }
                    },
                    "title": "Pods Succeeded"
                },
                "xPos": 12,
                "yPos": 29,
                "height": 3,
                "width": 6
            },
            {
                "widget": {
                    "scorecard": {
                        "sparkChartView": {
                            "sparkChartType": "SPARK_LINE"
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_status_phase{cluster=~\"${cluster.value}\",namespace=~\"${namespace.value}\", phase=\"Failed\"})"
                        }
                    },
                    "title": "Pods Failed"
                },
                "xPos": 18,
                "yPos": 29,
                "height": 3,
                "width": 6
            },
            {
                "widget": {
                    "scorecard": {
                        "sparkChartView": {
                            "sparkChartType": "SPARK_LINE"
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_status_phase{cluster=~\"${cluster.value}\",namespace=~\"${namespace.value}\", phase=\"Pending\"})"
                        }
                    },
                    "title": "Pods Pending"
                },
                "xPos": 12,
                "yPos": 32,
                "height": 3,
                "width": 6
            },
            {
                "widget": {
                    "scorecard": {
                        "sparkChartView": {
                            "sparkChartType": "SPARK_LINE"
                        },
                        "thresholds": [],
                        "timeSeriesQuery": {
                            "prometheusQuery": "sum(kube_pod_status_phase{cluster=~\"${cluster.value}\",namespace=~\"${namespace.value}\", phase=\"Unknown\"})"
                        }
                    },
                    "title": "Pods Unknown"
                },
                "xPos": 18,
                "yPos": 32,
                "height": 3,
                "width": 6
            },
            {
                "widget": {
                    "text": {
                        "content": "### Containers",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 14
            },
            {
                "widget": {
                    "text": {
                        "content": "### HPA",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 15
            },
            {
                "widget": {
                    "text": {
                        "content": "### Jobs",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 16
            },
            {
                "widget": {
                    "text": {
                        "content": "### PVC",
                        "format": "MARKDOWN",
                        "style": {
                            "backgroundColor": "#FFFFFF",
                            "fontSize": "FS_LARGE",
                            "horizontalAlignment": "H_LEFT",
                            "padding": "P_EXTRA_SMALL",
                            "textColor": "#212121",
                            "verticalAlignment": "V_TOP"
                        }
                    }
                },
                "width": 24,
                "height": 3,
                "xPos": 0,
                "yPos": 17
            }
        ]
    }
}